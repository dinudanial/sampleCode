<?php

class Admin_Model_BuslineDao extends Zend_Db_Table_Abstract
{
    protected $_name= 'LineOfBusiness';
    protected $_primary = 'ID_LineOfBusiness';
    
    public function saveBusline(array $buslineDetails)
    {
        try {
            
           $result = $this->createRow($buslineDetails);
           $result->save();

        } catch (Zend_Db_Table_Exception $ex) {
            throw new Exception($ex->getMessage());
        }
           
    }
    
    public function editBuslines(array $buslineDetails,$id)
    {
        
       
        try {
           $data=$buslineDetails;
            $where['ID_LineOfBusiness=?']=$id;
            $this->update($data, $where);
            
        } catch (Zend_Db_Table_Exception $exc) {
            throw new Exception($ex->getMessage());
        }
        }


    public function getBuslines()
    {
        try {
            $select=$this->select();
            $select->from($this,array('ID_LineOfBusiness','d__LineName','ID_InsuranceClass','s__Enabled'));
            $stmt=$select->query();
            $row=$stmt->fetchAll();
            if($row)
                return $row;
             else
                return false;
            
        } catch (Zend_Db_Table_Exception $exc) {
            echo $exc->getMessage();
        }
                    
    }
    
    public function findBusline($buslineId)
    {
        try {
            $select=  $this->select();
            $select->from($this,array('d__LineName','ID_InsuranceClass','ID_LineOfBusiness','s__Enabled'))
                   ->where('ID_LineOfBusiness=?',$buslineId);
            $stmt=$select->query();
            $row=$stmt->fetch();
            if($row)
              return $row;
            else
                return false;
            
        } catch (Zend_Db_Table_Exception $exc) {
            echo $exc->getMessage();
        }
    }
    
    public function findBuslineByInsurance($insuranceId)
    {
        try {
            $select = $this->select();
            $select->from($this,array('d__LineName','ID_InsuranceClass','ID_LineOfBusiness','s__Enabled'))
                   ->where('ID_InsuranceClass=?',$insuranceId);
            $stmt=$select->query();
            $rows=$stmt->fetchAll();
          
            if($rows)
                return $rows;
            else
                return false;
            
        } catch (Zend_Db_Table_Exception $exc) {
            echo $exc->getTraceAsString();
        }
        }
        
        public function changestatus($buslineId,$status)
        {
            if($status==1)
            {
                $data=array('s__Enabled'=>'0');
                
                $where['ID_LineOfBusiness=?']=$buslineId;
                $this->update($data, $where);
                return 0;
            }
            else
            {
                
                $data=array('s__Enabled'=>'1');
                            
                $where['ID_LineOfBusiness=?']=$buslineId;
                $this->update($data, $where);
                return 1;
            }
          
        }
        
        public function deletebusinessline($buslineId)
        {
        
            try {
         
                $where['ID_LineOfBusiness=?']=$buslineId;
                $this->delete($where);
                
                
            } catch (Zend_Db_Table_Exception $exc) {
                echo $exc->getMessage();
            }
                }
     
}

